{%extends 'base.html' %}

{%block title%} {{room.name}} {%endblock%}

{% block content%}

    <div class="p-10 lg:p-20 text-center">
        <h1 class="text-3xl lg:text-6xl text-black">{{room.name}}</h1>
    </div>

    <div class="lg:w-2/4 mx-4 lg:mx-auto p-4 bg-white rounded-xl">
        <div class="chat-messages space-y-3" id="chat-messages">
            <div class="p-4 bg-gray-200 rounded-xl">
                <p class="font-semibold">Username</p>
                <p>message</p>
            </div>



        </div>
    </div>

    <div class="lg:w-2/4 mt-6 mx-4 lg:mx-auto p-4 bg-white rounded-xl">
        <form action="." method="post" id="chat-form">
            <div class="flex flex-col lg:flex-row">
                <input type="text" name="message" id="message" class="p-2 rounded-xl border border-gray-300 lg:w-3/4" placeholder="Type your message here...">
                <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-xl lg:ml-2 lg:w-1/4">Send</button>
            </div>
        </form>
    </div>



{% endblock%}


{%block scripts%}

    {{room.slug|json_script:"json-roomname"}}
    {{request.user.username| json_script:"json-username"}}
    <script>
        const roomName=JSON.parse(document.getElementById("json-roomname").textContent);
        const userName=JSON.parse(document.getElementById("json-username").textContent);

        
        const chatSocket = new WebSocket(
            'ws://'
            + window.location.host
            +'/ws/'
            +roomName
            +'/'

        );
        chatSocket.onerror = function (error) {
            console.error('WebSocket error:', error);
        }
        

        chatSocket.onmessage=function(e) {
            console.log('onmessage')
        }

        chatSocket.onclose=function(e) {
            console.log('onclose')
        }

    </script>
{%endblock%}